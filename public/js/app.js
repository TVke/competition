var possible=["/img/fotos.jpg","/img/gebruik.jpg","/img/iphone.jpg","/img/mensen.jpg"],koala={version:"1.8.2"};!function(e,t){function n(e,t){var n=[];return function(t,r,o){if(!(t<0||r<0)){if(3===arguments.length)return n[e*t+r]=o;if(2===arguments.length)return n[e*t+r];throw new TypeError("Bad number of arguments")}}}function r(e,t,n,r){return[(e[0]+t[0]+n[0]+r[0])/4,(e[1]+t[1]+n[1]+r[1])/4,(e[2]+t[2]+n[2]+r[2])/4]}function o(e,t,n,r,o,a,i,l){this.vis=e,this.x=r*(t+.5),this.y=r*(n+.5),this.size=r,this.color=o,this.rgb=d3.rgb(o[0],o[1],o[2]),this.children=a,this.layer=i,this.onSplit=l}function a(e,t){"LayerClear"===e&&0===t&&document.getElementById("msg").classList.add("show"),"LayerClear"===e&&5===t&&clearInterval(l)}koala.supportsCanvas=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},koala.supportsSVG=function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},o.prototype.isSplitable=function(){return this.node&&this.children},o.prototype.split=function(){this.isSplitable()&&(d3.select(this.node).remove(),delete this.node,o.addToVis(this.vis,this.children),this.onSplit(this))},o.prototype.checkIntersection=function(e,t){var n=this.x-t[0],r=this.y-t[1],o=this.x-e[0],a=this.y-e[1],i=this.size/2;return i*=i,n*n+r*r<=i&&o*o+a*a>i},o.addToVis=function(e,t,n){var r=e.selectAll(".nope").data(t).enter().append("circle");(r=n?r.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}).attr("r",4).attr("fill","#ffffff").transition().duration(1e3):r.attr("cx",function(e){return e.parent.x}).attr("cy",function(e){return e.parent.y}).attr("r",function(e){return e.parent.size/2}).attr("fill",function(e){return String(e.parent.rgb)}).attr("fill-opacity",.68).transition().duration(300)).attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}).attr("r",function(e){return e.size/2}).attr("fill",function(e){return String(e.rgb)}).attr("fill-opacity",1).each("end",function(e){e.node=this})};var i,l,s=document.getElementById("dots"),c=s.offsetWidth-40,u=256===c?4:8,f=c/u,d=(s.getElementsByTagName("svg")[0],!1);if(koala.loadImage=function(e){var t=document.createElement("canvas").getContext("2d");return t.drawImage(e,0,0,f,f),t.getImageData(0,0,f,f).data},koala.makeCircles=function(e,t,a){function s(e){var t=Math.floor(e[0]/u),n=Math.floor(e[1]/u),r=b(t,n);if(!r)return null;for(;r&&!r.isSplitable();)r=r.parent;return r||null}function h(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}function p(e,t,n){for(var r=[],o=h(e,t),a=Math.max(Math.ceil(o/n),1),i=(t[0]-e[0])/a,l=(t[1]-e[1])/a,s=e[0],c=e[1],u=0;u<=a;u++)r.push([s+i*u,c+l*u]);return r}function v(e,t){for(var n=p(e,t,4),r=0;r<n.length-1;r++){var o=n[r],a=n[r+1],i=s(a);i&&i.isSplitable()&&i.checkIntersection(o,a)&&i.split()}}function m(){for(var e=d3.event.changedTouches,t=0;t<e.length;t++){var n=e.item(t);N[n.identifier]=null}d3.event.preventDefault()}a=a||function(){};var g=[],y=0,w=0;i?i.selectAll("circle").remove():i=d3.select(e).append("svg").attr("width",c).attr("height",c);var k,S,x,b=n(f),I=u,C=0;for(S=0;S<f;S++)for(k=0;k<f;k++)x=[t[C],t[C+1],t[C+2]],b(k,S,new o(i,k,S,I,x)),C+=4;for(var E,M,T,V,B,F=b,L=0;I<c;){for(I*=2,E=n(f/=2),S=0;S<f;S++)for(k=0;k<f;k++)M=F(2*k,2*S),T=F(2*k+1,2*S),V=F(2*k,2*S+1),B=F(2*k+1,2*S+1),x=r(M.color,T.color,V.color,B.color),M.parent=T.parent=V.parent=B.parent=E(k,S,new o(i,k,S,I,x,[M,T,V,B],L,function(e){var t=e.layer;g[t]--,0===g[t]&&a("LayerClear",t),1-d3.sum(g)/y>=w&&(a("PercentClear",Math.round(100*w)),w+=.05)}));g.push(f*f),y+=f*f,L++,F=E}o.addToVis(i,[E(0,0)],!0);var D=null,N={};d3.select("div#dots").on("mousemove.koala",function(){var e=d3.mouse(i.node());isNaN(e[0])?D=null:(D&&v(D,e),D=e,d3.event.preventDefault())}).on("touchmove.koala",function(){for(var e=d3.touches(i.node()),t=0;t<e.length;t++){var n=e[t],r=N[n.identifier];r&&v(r,n),N[n.identifier]=n}d3.event.preventDefault()}).on("touchend.koala",m).on("touchcancel.koala",m),l=setInterval(function(){d&&v([0,0],[125,125])},100)},e.shownFile="none",koala.supportsCanvas())if(koala.supportsSVG()){var h=function(e){var t=possible[Math.floor(Math.random()*possible.length)];return{file:t,shownFile:e.protocol+"//"+e.host+t}}(location);if(h){var p=h.file;e.shownFile=h.shownFile;var v=new Image;v.onload=function(){var e;(e=koala.loadImage(this))&&koala.makeCircles("#dots",e,a)},v.src=p,document.getElementById("start").addEventListener("click",function(e){e.preventDefault(),document.getElementById("game").removeAttribute("class"),d=!0})}}else alert("Sorry, Je moet de site openen in een browser die SVG ondersteund. Zoals: Chrome, Safari, Firefox, Opera, en Internet Explorer vanaf versie 10");else alert("Sorry, Je moet de site openen in een browser die HTML5 Canvas ondersteund. Zoals: Chrome, Safari, Firefox, Opera, en Internet Explorer vanaf versie 10")}(window);