var possible=["/img/fotos.jpg","/img/gebruik.jpg","/img/iphone.jpg","/img/mensen.jpg"],koala={version:"1.8.2"};!function(e,t){function n(e,t){var n=[];return function(t,r,o){if(!(t<0||r<0)){if(3===arguments.length)return n[e*t+r]=o;if(2===arguments.length)return n[e*t+r];throw new TypeError("Bad number of arguments")}}}function r(e,t,n,r){return[(e[0]+t[0]+n[0]+r[0])/4,(e[1]+t[1]+n[1]+r[1])/4,(e[2]+t[2]+n[2]+r[2])/4]}function o(e,t,n,r,o,a,i,l){this.vis=e,this.x=r*(t+.5),this.y=r*(n+.5),this.size=r,this.color=o,this.rgb=d3.rgb(o[0],o[1],o[2]),this.children=a,this.layer=i,this.onSplit=l}function a(e,t){"LayerClear"===e&&0===t&&(document.getElementById("msg").classList.add("show"),clearInterval(p),document.getElementsByName("time")[0].value=k,u("end",!0,d)),"LayerClear"===e&&5===t&&(clearInterval(h),p=setInterval(i,100),u("start",!0,c))}function i(){++k,S.innerHTML=l(k)}function l(e){return s(e/10/60%60,2)+":"+s(e/10%60,2)+","+s(e%10,1)}function s(e,t){return((e=Math.floor(e))+"").length<t?"0"+e:e}function u(e,t,n){var r,o=new XMLHttpRequest;r="_token="+x+"&ip="+document.getElementsByName("ip")[0].value,E&&(r+="&et="+E),o.open("POST","/"+e),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),t&&(o.onreadystatechange=function(){4===o.readyState&&200===o.status&&n(o.responseText)}),o.send(r)}function c(e){E=e}function d(e){c(e);var t=document.createElement("input");t.type="hidden",t.value=E,t.name="et",document.getElementsByTagName("form")[0].appendChild(t)}koala.supportsCanvas=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},koala.supportsSVG=function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},o.prototype.isSplitable=function(){return this.node&&this.children},o.prototype.split=function(){this.isSplitable()&&(d3.select(this.node).remove(),delete this.node,o.addToVis(this.vis,this.children),this.onSplit(this))},o.prototype.checkIntersection=function(e,t){var n=this.x-t[0],r=this.y-t[1],o=this.x-e[0],a=this.y-e[1],i=this.size/2;return i*=i,n*n+r*r<=i&&o*o+a*a>i},o.addToVis=function(e,t,n){var r=e.selectAll(".nope").data(t).enter().append("circle");(r=n?r.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}).attr("r",4).attr("fill","#ffffff").transition().duration(1e3):r.attr("cx",function(e){return e.parent.x}).attr("cy",function(e){return e.parent.y}).attr("r",function(e){return e.parent.size/2}).attr("fill",function(e){return String(e.parent.rgb)}).attr("fill-opacity",.68).transition().duration(300)).attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}).attr("r",function(e){return e.size/2}).attr("fill",function(e){return String(e.rgb)}).attr("fill-opacity",1).each("end",function(e){e.node=this})};var f,h,p,m=document.getElementById("dots").offsetWidth-40,v=256===m?4:8,g=m/v,y=document.getElementById("start"),w=!1,k=0,S=document.getElementsByTagName("time")[0],x=document.getElementsByName("_token")[0].value,E=!1;if(koala.loadImage=function(e){var t=document.createElement("canvas").getContext("2d");return t.drawImage(e,0,0,g,g),t.getImageData(0,0,g,g).data},koala.makeCircles=function(e,t,a){function i(e){var t=Math.floor(e[0]/v),n=Math.floor(e[1]/v),r=E(t,n);if(!r)return null;for(;r&&!r.isSplitable();)r=r.parent;return r||null}function l(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}function s(e,t,n){for(var r=[],o=l(e,t),a=Math.max(Math.ceil(o/n),1),i=(t[0]-e[0])/a,s=(t[1]-e[1])/a,u=e[0],c=e[1],d=0;d<=a;d++)r.push([u+i*d,c+s*d]);return r}function u(e,t){for(var n=s(e,t,4),r=0;r<n.length-1;r++){var o=n[r],a=n[r+1],l=i(a);l&&l.isSplitable()&&l.checkIntersection(o,a)&&l.split()}}function c(){for(var e=d3.event.changedTouches,t=0;t<e.length;t++){var n=e.item(t);F[n.identifier]=null}d3.event.preventDefault()}a=a||function(){};var d=[],p=0,y=0;f?f.selectAll("circle").remove():f=d3.select(e).append("svg").attr("width",m).attr("height",m);var k,S,x,E=n(g),I=v,b=0;for(S=0;S<g;S++)for(k=0;k<g;k++)x=[t[b],t[b+1],t[b+2]],E(k,S,new o(f,k,S,I,x)),b+=4;for(var C,M,T,B,L,N=E,V=0;I<m;){for(I*=2,C=n(g/=2),S=0;S<g;S++)for(k=0;k<g;k++)M=N(2*k,2*S),T=N(2*k+1,2*S),B=N(2*k,2*S+1),L=N(2*k+1,2*S+1),x=r(M.color,T.color,B.color,L.color),M.parent=T.parent=B.parent=L.parent=C(k,S,new o(f,k,S,I,x,[M,T,B,L],V,function(e){var t=e.layer;d[t]--,0!==d[t]||0!==t&&5!==t||a("LayerClear",t),1-d3.sum(d)/p>=y&&(a("PercentClear",Math.round(100*y)),y+=.05)}));d.push(g*g),p+=g*g,V++,N=C}o.addToVis(f,[C(0,0)],!0);var q=null,F={};d3.select("div#dots").on("mousemove.koala",function(){var e=d3.mouse(f.node());isNaN(e[0])?q=null:(q&&u(q,e),q=e,d3.event.preventDefault())}).on("touchmove.koala",function(){for(var e=d3.touches(f.node()),t=0;t<e.length;t++){var n=e[t],r=F[n.identifier];r&&u(r,n),F[n.identifier]=n}d3.event.preventDefault()}).on("touchend.koala",c).on("touchcancel.koala",c),h=setInterval(function(){w&&u([0,0],[125,125])},100)},e.shownFile="none",koala.supportsCanvas())if(koala.supportsSVG()){var I=function(e){var t=possible[Math.floor(Math.random()*possible.length)];return{file:t,shownFile:e.protocol+"//"+e.host+t}}(location);if(I){var b=I.file;e.shownFile=I.shownFile;var C=new Image;C.onload=function(){var e;(e=koala.loadImage(this))&&koala.makeCircles("#dots",e,a)},C.src=b,y.addEventListener("click",function(e){e.preventDefault(),document.getElementById("game").removeAttribute("class"),w=!0})}}else alert("Sorry, Je moet de site openen in een browser die SVG ondersteund. Zoals: Chrome, Safari, Firefox, Opera, en Internet Explorer vanaf versie 10");else alert("Sorry, Je moet de site openen in een browser die HTML5 Canvas ondersteund. Zoals: Chrome, Safari, Firefox, Opera, en Internet Explorer vanaf versie 10")}(window);